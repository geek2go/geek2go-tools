<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Geek2Go Computer Repair Checklist</title>
  <link rel="stylesheet" href="shared.css">
  <style>
    :root {
      --bg: #f9f9f9;
      --card-bg: #ffffff;
      --border: #e5e7eb;
      --text: #000000;
      --input-bg: #ffffff;
      --button-bg: #C10A11;
      --button-secondary-bg: #ffffff;
      --button-secondary-color: #C10A11;
      --muted: #6b7280;
      --accent: #C10A11;
      --chip-border: #fecaca;
      --chip-bg: #fee2e2;
      --chip-color: #991b1b;
      --radius: 8px;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-size: 15px;
      line-height: 1.55;
      font-family: Arial, sans-serif;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0;
    }

    .page-header {
      background: #ffffff;
      padding: 18px 20px;
      border-bottom: 1px solid var(--border);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      margin-bottom: 20px;
    }

    .page-header h1 {
      font-size: 24px;
      margin: 8px 0 6px;
      font-weight: 700;
    }

    .page-header p {
      margin: 0;
      color: var(--muted);
      font-size: 15px;
    }

    .content {
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 0.8fr;
      gap: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .left-column {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .right-column {
      position: sticky;
      top: 20px;
      align-self: start;
    }

    h1 {
      font-size: 24px;
      margin: 0 0 6px;
      font-weight: 700;
    }

    p {
      margin: 0 0 10px;
      color: var(--muted);
    }

    .card {
      padding: 16px;
      margin-bottom: 0;
    }

    @media (max-width: 1024px) {
      .content {
        grid-template-columns: 1fr;
      }

      .right-column {
        position: relative;
        top: 0;
      }
    }

    .row {
      display: grid;
    }

    textarea {
      min-height: 120px;
      font-family: ui-monospace, SFMono-Regular, Consolas, monospace;
    }

    #src {
      min-height: 200px;
    }

    #out {
      font-family: ui-monospace, SFMono-Regular, Consolas, monospace;
      background: #f9fafb;
    }

    select {
      background: #fff;
    }

    button {
      appearance: none;
      border: 1px solid var(--accent);
      background: var(--accent);
      color: #fff;
      font-weight: 700;
    }

    .section-title {
      font-weight: 800;
    }

    .out {
      min-height: 220px;
    }

    label.chk {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    hr {
      border: none;
      border-top: 1px dashed var(--border);
      margin: 8px 0;
    }
  </style>
</head>
<body>
<div class="wrap">
  <div class="page-header">
    <a href="index.html" style="display: inline-block; color: var(--accent); text-decoration: none; font-size: 14px; font-weight: 600;">← Back to Tools</a>
    <h1>Computer Repair Checklist</h1>
    <p>Document hardware diagnostics and service work performed. Paste a PC-Doctor report or enter information manually to generate professional ticket notes.</p>
  </div>

  <div class="content">
  <!-- Left Column -->
  <div class="left-column">

  <!-- 1) PASTE PC-DOCTOR REPORT -->
  <div class="card row">
    <label for="src" class="section-title">1) Paste PC‑Doctor Report (Optional)</label>
    <textarea id="src" placeholder="Ctrl+A → Ctrl+C from Service Center Remote, then paste here… (or leave blank to summarize add‑ons only)"></textarea>
    <div class="buttons">
      <button class="secondary" id="sample">Load Sample</button>
      <button class="secondary" id="clear">Clear</button>
    </div>
  </div>

  <!-- 2) OPTIONAL ADD‑ONS -->
  <div class="card row">
    <div class="section-title">2) Additional Work Performed</div>

    <!-- Presets -->
    <div class="toolbar">
      <span class="hint" style="margin-right:6px">Presets:</span>
      <button class="chip" id="preset_quick">Standard Tune-Up</button>
      <button class="chip" id="preset_newpc">New PC Setup</button>
      <button class="secondary" id="save_defaults">Save Defaults</button>
      <button class="secondary" id="load_defaults">Load Defaults</button>
    </div>

    <div class="grid grid-2">
      <!-- Malwarebytes -->
      <div>
        <label class="chk"><input type="checkbox" id="mbam_chk"> Malwarebytes Scan</label>
        <div class="toolbar">
          <label>Result
            <select id="mbam_result">
              <option value="Clean">Clean</option>
              <option value="Threats removed">Threats removed</option>
              <option value="Infected – manual action taken">Infected – manual action taken</option>
            </select>
          </label>
          <input id="mbam_notes" type="text" placeholder="Notes (optional)"/>
        </div>
      </div>

      <!-- Windows/Driver Updates -->
      <div>
        <label class="chk"><input type="checkbox" id="updates_chk"> Windows & Driver Updates</label>
        <div class="toolbar">
          <label>Status
            <select id="updates_status">
              <option value="Completed">Completed</option>
              <option value="Partial">Partial</option>
              <option value="Deferred">Deferred</option>
            </select>
          </label>
          <input id="updates_notes" type="text" placeholder="Notes (e.g., BIOS, GPU, optional KB…)"/>
        </div>
      </div>

      <!-- Software Installed -->
      <div>
        <label class="chk"><input type="checkbox" id="software_chk"> Software Installed</label>
        <input id="software_list" type="text" placeholder="e.g., Office, Chrome, Adobe Reader"/>
      </div>

      <!-- Additional Work -->
      <div>
        <label class="chk"><input type="checkbox" id="other_chk"> Additional Work Performed</label>
        <input id="other_notes" type="text" placeholder="e.g., data migration, hardware upgrade, cleaning"/>
      </div>
    </div>

    <hr/>

    <!-- Additional Details -->
    <div class="grid grid-2">
      <div>
        <label>Additional Diagnostics / Notes<br/>
          <input id="otherDiagnostics" type="text" placeholder="e.g., Battery health: 92%, SSD test passed, memtest OK"/>
        </label>
      </div>
      <div>
        <div class="section-title" style="margin-bottom:6px">Maintenance Performed</div>
        <div class="toolbar">
          <label class="chk"><input type="checkbox" id="chkTemp"> Temp Files Cleaned</label>
          <label class="chk"><input type="checkbox" id="chkClean"> System Cleaned</label>
        </div>
      </div>
    </div>

    <hr/>

    <!-- Technician -->
    <div class="grid">
      <input id="tech_name" type="text" placeholder="Technician name (optional)"/>
      <label for="tech_notes" class="section-title">Technician Notes</label>
      <textarea id="tech_notes" placeholder="Customer‑friendly notes… (ex: Cleaned temp files, verified thermals and fans.)"></textarea>
    </div>
  </div>

  </div><!-- /left-column -->

  <!-- Right Column - Output -->
  <div class="right-column">
    <div class="card row">
      <label for="out" class="section-title">Summary Output</label>
      <textarea id="out" class="out" placeholder="Summary will appear here…" style="min-height: 500px;"></textarea>
      <div class="buttons">
        <button id="summarize">Generate Summary</button>
        <button class="secondary" id="copy">Copy to Clipboard</button>
      </div>
      <p class="hint">Click "Generate Summary" to create the output. You can make changes on the left and regenerate as needed.</p>
    </div>
  </div><!-- /right-column -->

  </div><!-- /content -->
</div><!-- /wrap -->

<script>
(function(){
  const $ = (id)=>document.getElementById(id);

  // Helpers
  function L(txt){ return txt.replace(/\r/g,'').split(/\n+/).map(s=>s.trim()).filter(Boolean); }
  function pick(re, txt){ const m = txt.match(re); return m? (m[1]||m[0]).trim() : ''; }
  function setChecked(id, v){ const el=$(id); if(el) el.checked=!!v; }
  function setVal(id, v){ const el=$(id); if(el && typeof v==='string') el.value=v; }

  // CPU parser - simplified to find Intel/AMD processors
  function parseCPU(txt){
    // Look for common CPU patterns (Intel or AMD)
    const cpuLine = txt.match(/(Intel|AMD).*(Core|Ryzen|Pentium|Celeron|Athlon|Threadripper|Xeon)[^\n]*/i);
    let header = cpuLine ? cpuLine[0].replace(/\(CPU:\s*\d+\)/i, '').trim() : '';

    // Extract cores and threads from nearby text
    const cores = pick(/Cores\s+(\d+)/i, txt);
    const threads = pick(/Threads\s+(\d+)/i, txt);

    return {header, cores, threads};
  }

  // RAM parser - extract total memory and module details
  function parseRAM(txt){
    const total = pick(/Total Physical Memory\s*([\d.]+\s*GB)/i, txt);

    // Match RAM modules (e.g., "16384 MB DDR4-SDRAM (2400 MHz)")
    const modRe = /(\d{3,6})\s*MB\s*(DDR\d)(?:-[A-Z]+)?\s*\((\d{3,5})\s*MHz\)/ig;
    const mods = [];

    for(const m of txt.matchAll(modRe)){
      const gb = Math.round(parseInt(m[1], 10) / 1024 * 100) / 100;
      mods.push({gb, type: m[2], mhz: m[3]});
    }

    let modulesPart = '';
    if(mods.length){
      const allSameSize = mods.every(x => x.gb === mods[0].gb);
      modulesPart = allSameSize
        ? `${mods.length}×${mods[0].gb}GB ${mods[0].type} (${mods[0].mhz} MHz)`
        : `${mods.length} modules ${mods[0].type}`;
    }

    return {total, modulesPart};
  }

  // Storage
  function parseStorage(txt){
    const model = pick(/Model\s*Number\s*([^\n]+)/i, txt) || pick(/^(BC\d{3,4}.*|Samsung SSD.*|WDC.*|Seagate.*|Crucial.*|Kingston.*|SK\s*hynix.*)$/im, txt);
    const capacity = pick(/Total\s*Capacity\s*([\d.]+\s*(?:GB|TB))/i, txt) || pick(/Size\s*([\d.]+\s*(?:GB|TB))/i, txt);
    const free = pick(/C:\s*[\s\S]*?Volume\s*Free\s*Space\s*([\d.]+\s*(?:GB|TB))/i, txt) || pick(/Volume\s*Free\s*Space\s*([\d.]+\s*(?:GB|TB))/i, txt);
    return {model, capacity, free};
  }

  // GPU
  function parseGPU(txt){
    const gpus=[]; const re=/(NVIDIA\s+[^\n]+|AMD\s+Radeon[^\n]+|Intel\s+(?:UHD|Iris)[^\n]+)/ig; for(const m of txt.matchAll(re)) gpus.push(m[1].trim());
    const seen=new Set(); return gpus.filter(g=>{const k=g.toLowerCase(); if(seen.has(k)) return false; seen.add(k); return true;}).slice(0,2);
  }

  // OS
  function parseOS(txt){
    const os = pick(/Operating\s*System:\s*([^\n]+)/i, txt);
    const ver = pick(/Version:\s*([^\n]+)/i, txt);
    const build = pick(/Build\s*Number:\s*([^\n]+)/i, txt);
    const date = pick(/Test\s*Date:\s*([^\n]+)/i, txt);
    return {os, ver, build, date};
  }

  // Test results parser - simplified to detect component tests and failures
  function parseTests(txt){
    const FAIL_TOKENS = /(Failed|Error|Critical|Bad|SMART\s*Warning|SMART\s*Failure)/i;

    // Check if a test category exists
    const has = (pattern) => new RegExp(pattern, 'i').test(txt);

    // Check if any tests in a category failed
    const hasFailed = (pattern) => {
      const matches = txt.match(new RegExp(pattern + '[\\s\\S]{0,100}', 'ig')) || [];
      return matches.some(block => FAIL_TOKENS.test(block));
    };

    const lines = [];

    // CPU Tests
    if(has('Register Test|Stress Test|MMX Test|AVX2 Test')){
      const failed = hasFailed('Register Test|Stress Test|MMX Test|AVX2 Test');
      lines.push(`- CPU: ${failed ? 'Issue detected' : 'Passed'}`);
    }

    // RAM Tests
    if(has('Windows Memory Test|Checkerboard Test|Modulo20 Test|Moving Inversion Test')){
      const failed = hasFailed('Windows Memory Test|Checkerboard Test|Modulo20 Test|Moving Inversion Test');
      lines.push(`- RAM: ${failed ? 'Issue detected' : 'Passed'}`);
    }

    // Storage Tests
    if(has('SMART Status Test|NVMe Status Test|Targeted Read Test|Wear Level Test')){
      const failed = hasFailed('SMART Status Test|NVMe Status Test|Targeted Read Test|Wear Level Test');
      lines.push(`- Storage: ${failed ? 'Issue detected' : 'Passed'}`);
    }

    // GPU Tests
    if(has('Shader Rendering|GPU Pipeline Data|Video Memory Test')){
      const failed = hasFailed('Shader Rendering|GPU Pipeline Data|Video Memory Test');
      lines.push(`- GPU: ${failed ? 'Issue detected' : 'Passed'}`);
    }

    // Network Tests (with special handling for "No Cable")
    if(has('Network Link Test|Internet Communication Test|TCP/IP')){
      const failed = hasFailed('Network Link Test|Internet Communication Test|TCP/IP');
      const noCable = /No\s+Cable/i.test(txt);

      if(failed){
        lines.push('- Network: Issue detected');
      } else if(noCable){
        lines.push('- Network: Passed (Ethernet not connected)');
      } else {
        lines.push('- Network: Passed');
      }
    }

    // System Board Tests
    if(has('System Board|PCI Express Status Test|CMOS|RTC Accuracy Test|TPM Self Test')){
      const failed = hasFailed('System Board|PCI Express Status Test|CMOS|RTC Accuracy Test|TPM Self Test');
      lines.push(`- System Board & other components: ${failed ? 'Issue detected' : 'Passed'}`);
    }

    // Overall result
    const overall = FAIL_TOKENS.test(txt)
      ? 'One or more issues detected.'
      : 'All hardware components tested PASSED. No issues found.';

    return {lines, overall};
  }

  // Add‑ons builder
  function buildAddOns(){
    const parts=[];
    if($('mbam_chk').checked){ let s=`- Malwarebytes: ${$('mbam_result').value}`; const n=$('mbam_notes').value.trim(); if(n) s+=` — ${n}`; parts.push(s); }
    if($('updates_chk').checked){ let s=`- Windows & Drivers: ${$('updates_status').value}`; const n=$('updates_notes').value.trim(); if(n) s+=` — ${n}`; parts.push(s); }
    if($('software_chk').checked){ const list=$('software_list').value.trim(); parts.push(`- Software Installed${list? ': '+list:''}`); }
    if($('other_chk').checked){ const n=$('other_notes').value.trim(); if(n) parts.push(`- Additional Work: ${n}`); }

    const od=$('otherDiagnostics').value.trim(); if(od) parts.push(`- Additional Diagnostics: ${od}`);

    const maint=[];
    if($('chkTemp').checked) maint.push('Temp Files Cleaned');
    if($('chkClean').checked) maint.push('System Cleaned');
    if(maint.length) parts.push(`- Maintenance: ${maint.join(', ')}`);

    const tech=$('tech_name').value.trim(); const notes=$('tech_notes').value.trim();
    return {parts, tech, notes};
  }

  // Main summary
  function buildSummary(txt){
    const src = (txt||'').trim();
    const add=buildAddOns();

    if(!src){
      const out=[];
      if(add.parts.length || add.notes || add.tech){
        out.push('Additional Work');
        out.push(...add.parts);
        if(add.notes) out.push(`- Technician Notes: ${add.notes}`);
        if(add.tech) out.push(`- Technician: ${add.tech}`);
      } else {
        out.push('No PC‑Doctor report pasted and no add‑ons selected.');
      }
      return out.join('\n');
    }

    const cpu=parseCPU(src), ram=parseRAM(src), sto=parseStorage(src), gpus=parseGPU(src), os=parseOS(src), tests=parseTests(src);
    const out=[];
    out.push('System Information');
    out.push(`- CPU: ${cpu.header || 'Not detected'}${cpu.cores? ` (${cpu.cores} cores${cpu.threads? '/'+cpu.threads+' threads':''})`:''}`);
    out.push(`- Memory: ${ram.total || 'Not detected'}${ram.modulesPart? ' ('+ram.modulesPart+')':''}`);
    out.push(`- Storage: ${[sto.model, sto.capacity].filter(Boolean).join(' ')}${sto.free? ` • C: ${sto.free} free`:''}` || '- Storage: Not detected');
    if(gpus.length===1) out.push(`- Graphics: ${gpus[0]}`);
    if(gpus.length>1) out.push(`- Graphics: ${gpus[0]} + ${gpus[1]}`);
    out.push(`- OS: ${[os.os, os.ver && os.ver, os.build && 'Build '+os.build].filter(Boolean).join(', ') || 'Not detected'}`);
    if(os.date) out.push(`- Test Date: ${os.date}`);

    out.push('\nTest Results:');
    out.push(...tests.lines);

    if(add.parts.length || add.notes || add.tech){
      out.push('\nAdditional Work');
      out.push(...add.parts);
      if(add.notes) out.push(`- Technician Notes: ${add.notes}`);
      if(add.tech) out.push(`- Technician: ${add.tech}`);
    }

    out.push('\nOverall Result: '+tests.overall);
    return out.join('\n');
  }

  // Presets
  function applyPreset(name){
    ['mbam_chk','updates_chk','software_chk','other_chk','chkTemp','chkClean'].forEach(id=>setChecked(id,false));
    switch(name){
      case 'quick':
        setChecked('mbam_chk',true); setVal('mbam_result','Clean'); setVal('mbam_notes','');
        setChecked('updates_chk',true); setVal('updates_status','Completed'); setVal('updates_notes','');
        setChecked('chkTemp',true);
        break;
      case 'newpc':
        setChecked('mbam_chk',true); setVal('mbam_result','Clean');
        setChecked('updates_chk',true); setVal('updates_status','Completed'); setVal('updates_notes','All drivers updated');
        setChecked('software_chk',true); setVal('software_list','Office, Chrome, Adobe Reader');
        setChecked('chkTemp',true); setChecked('chkClean',true);
        break;
    }
  }

  // Save/Load defaults
  function saveDefaults(){
    const data={
      mbam_chk: $('mbam_chk').checked, mbam_result: $('mbam_result').value, mbam_notes: $('mbam_notes').value,
      updates_chk: $('updates_chk').checked, updates_status: $('updates_status').value, updates_notes: $('updates_notes').value,
      software_chk: $('software_chk').checked, software_list: $('software_list').value,
      other_chk: $('other_chk').checked, other_notes: $('other_notes').value,
      otherDiagnostics: $('otherDiagnostics').value,
      chkTemp: $('chkTemp').checked, chkClean: $('chkClean').checked,
      tech_name: $('tech_name').value, tech_notes: $('tech_notes').value
    };
    localStorage.setItem('g2g_summarizer_defaults', JSON.stringify(data));
  }
  function loadDefaults(){
    const raw=localStorage.getItem('g2g_summarizer_defaults'); if(!raw) return; try{const d=JSON.parse(raw);
      setChecked('mbam_chk',d.mbam_chk); setVal('mbam_result',d.mbam_result); setVal('mbam_notes',d.mbam_notes);
      setChecked('updates_chk',d.updates_chk); setVal('updates_status',d.updates_status); setVal('updates_notes',d.updates_notes);
      setChecked('software_chk',d.software_chk); setVal('software_list',d.software_list);
      setChecked('other_chk',d.other_chk); setVal('other_notes',d.other_notes);
      setVal('otherDiagnostics',d.otherDiagnostics||'');
      setChecked('chkTemp',d.chkTemp); setChecked('chkClean',d.chkClean);
      setVal('tech_name',d.tech_name); setVal('tech_notes',d.tech_notes);
    }catch(e){}
  }

  // Wire up UI
  $('summarize').onclick = ()=>{ const src=$('src').value; $('out').value = buildSummary(src); };
  $('copy').onclick = async ()=>{ const txt=$('out').value; if(!txt) return; try{ await navigator.clipboard.writeText(txt);}catch(e){} };
  $('clear').onclick = ()=>{ $('src').value=''; $('out').value=''; };
  $('sample').onclick = ()=>{
    $('src').value = `Serial Number: 5CD9377C6L
Operating System: Microsoft Windows 11 Home (64-bit)
Version: 25H2
Build Number: 26200.7171
Test Date: 11/12/2025

Intel(R) Core(TM) i7-1065G7 CPU @ 1.30GHz (CPU:0)
Cores    4
Threads    8

System Memory
Total Physical Memory    16.00 GB
8192 MB DDR4-SDRAM (2666 MHz)
8192 MB DDR4-SDRAM (2666 MHz)

T-FORCE TM8FFE512G
Model Number    T-FORCE TM8FFE512G
Total Capacity    476.94 GB
C:
Volume Capacity    476.05 GB
Volume Free Space    399.97 GB

Intel(R) Iris(R) Plus Graphics
NVIDIA GeForce MX250

Register Test    Passed
Level 2 Cache Test    Passed
MMX Test    Passed
AVX2 Test    Passed
Stress Test    Passed
Windows Memory Test    Passed
Checkerboard Test    Passed
Moving Inversion Test    Passed
NVMe Status Test    Passed
Targeted Read Test (SSD)    Passed
Network Link Test    Passed
TCP/IP Internal Loopback Test    Passed
Internet Communication Test    Passed
Shader Rendering Test    Passed
GPU Pipeline Data Test    Passed
Video Memory Test    Passed
PCI Express Status Test    Passed`;
  };

  // Preset buttons
  $('preset_quick').onclick = ()=>applyPreset('quick');
  $('preset_newpc').onclick = ()=>applyPreset('newpc');

  // Save/load defaults
  $('save_defaults').onclick = saveDefaults;
  $('load_defaults').onclick = loadDefaults;
  loadDefaults();
})();
</script>
</body>
</html>
